<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <title>页面</title>
  <!-- 页面的元信息 -->
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1" />
  <!-- 页面主样式文件 -->
  <style>
    body,
    html,
    .ox {
      padding: 0;
      margin: 0;
    }

    .owo-animation {
      overflow: hidden;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      transform: translate3d(0, 0, 0);
      transform-style: preserve-3d;
    }

    .owo-animated {
      -webkit-animation-duration: 1s;
      animation-duration: 1s;
      -webkit-animation-fill-mode: both;
      animation-fill-mode: both;
    }

    .owo-animation-forward {
      z-index: 99;
    }

    a:link,
    a:visited {
      text-decoration: none;
    }

    /* 清除浮动 */
    .clear:after {
      content: "";
      height: 0;
      line-height: 0;
      display: block;
      visibility: hidden;
      clear: both;
      zoom: 1;
    }

    ul {
      margin: 0;
      padding: 0;
    }

    li {
      list-style: none;
    }

    .box[template="home"] {
      overflow: hidden;
    }

    [template="home"] .tool-box {
      position: fixed;
      width: 100px;
      height: 40px;
      bottom: 0;
      right: 0;
      cursor: pointer;
      z-index: 999;
    }
  </style>
  <!-- 附属css文件 -->
  <link rel="stylesheet" href="./static/css/main.css" charset="utf-8">


</head>

<body>
  <!-- 页面区域 -->
  <div class="box ox" template="home">
  </div>
  <!-- 框架script代码 -->
  <script>
    "use strict";

    // 存储页面基本信息
    var owo = {
      // 页面默认入口 如果没有设置 则取第一个页面为默认页面
      entry: "home",
      // 全局方法变量
      tool: {},
      // 框架状态变量
      state: {}
    };
    /*
      存储每个页面的函数
      键名：页面名称
      键值：方法列表
    */

    owo.script = {
      "home": {
        "data": {
          "controls": null,
          "camera": null,
          "scene": null,
          "renderer": null,
          "light": null,
          "clock": null,
          "type": "rotate",
          "model": null,
          "runing": false,
          "Material_58": null,
          "Material_59": null,
          "window_box_1": null,
          "window_box_2": null,
          "arrow_box": null,
          "waitTime": 0
        },
        "init": function init() {
          var _this = this;

          // 创建摄像机
          this.data.camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 20000);
          this.data.camera.position.set(0, 300, 400);
          this.data.controls = new THREE.OrbitControls(this.data.camera);
          this.data.controls.target.set(0, 100, 0);
          this.data.controls.update();
          this.data.scene = new THREE.Scene();
          this.data.scene.background = new THREE.Color(0xa0a0a0);
          this.data.light = new THREE.HemisphereLight(0xffffff, 0x444444);
          this.data.light.position.set(0, 200, 0);
          this.data.scene.add(this.data.light);
          this.data.light = new THREE.DirectionalLight(0xffffff);
          this.data.light.position.set(0, 200, 100);
          this.data.light.castShadow = true;
          this.data.light.shadow.camera.top = 180;
          this.data.light.shadow.camera.bottom = -100;
          this.data.light.shadow.camera.left = -120;
          this.data.light.shadow.camera.right = 120;
          this.data.scene.add(this.data.light); // this.data.scene.add( new THREE.CameraHelper( this.data.light.shadow.camera ) );
          // 网格线

          var grid = new THREE.GridHelper(2000, 20, 0x000000, 0x000000);
          grid.material.opacity = 0.2;
          grid.material.transparent = true;
          this.data.scene.add(grid); // model

          var loader = new THREE.FBXLoader();
          loader.load('./resource/1.FBX', function(object) {
            // console.log(object.getObjectByName('Material_58'))
            // object.scale.set(0.5, 0.5, 0.5)
            // 处理材质
            object.traverse(function(child) {
              // console.log(child.name)
              if (child.isMesh) {
                child.castShadow = true;
                child.receiveShadow = true;
              }
            });

            _this.data.scene.add(object);
          }); // 文字

          var textLoader = new THREE.FontLoader();
          textLoader.load('./resource/FZKaTong-M19S_Regular.json', function(font) {
            var textOptions = {
              size: 2,
              height: 0,
              font: font,
              bevelThickness: 1,
              bevelSize: 1,
              bevelSegments: 1,
              curveSegments: 50,
              steps: 1 // ID

            };
            var textGeo = new THREE.TextGeometry('ID: 000001G0010001', textOptions);
            var textMesh = new THREE.Mesh(textGeo, new THREE.MeshBasicMaterial());
            textMesh.position.set(-15, 109, 51);

            _this.data.scene.add(textMesh); // MeterCode


            var textGeo = new THREE.TextGeometry('P32', textOptions);
            var textMesh = new THREE.Mesh(textGeo, new THREE.MeshBasicMaterial());
            textMesh.position.set(-2, 187, 50);

            _this.data.scene.add(textMesh); // MeterName


            var textGeo = new THREE.TextGeometry('进线', textOptions);
            var textMesh = new THREE.Mesh(textGeo, new THREE.MeshBasicMaterial());
            textMesh.position.set(-3, 190, 50);

            _this.data.scene.add(textMesh); // MeterParamId


            var textGeo = new THREE.TextGeometry('31000000000700', textOptions);
            var textMesh = new THREE.Mesh(textGeo, new THREE.MeshBasicMaterial());
            textMesh.position.set(-15, 106, 51);

            _this.data.scene.add(textMesh); // MeterParamName


            var textGeo = new THREE.TextGeometry('A相电压', textOptions);
            var textMesh = new THREE.Mesh(textGeo, new THREE.MeshBasicMaterial());
            textMesh.position.set(-15, 97, 51);

            _this.data.scene.add(textMesh); // ParamCode


            var textGeo = new THREE.TextGeometry('ParamCode: Ua', textOptions);
            var textMesh = new THREE.Mesh(textGeo, new THREE.MeshBasicMaterial());
            textMesh.position.set(-15, 103, 51);

            _this.data.scene.add(textMesh); // CollectTime


            var textGeo = new THREE.TextGeometry('2019-08-25T21:25:00', textOptions);
            var textMesh = new THREE.Mesh(textGeo, new THREE.MeshBasicMaterial());
            textMesh.position.set(-15, 100, 51);

            _this.data.scene.add(textMesh); // Value


            var textGeo = new THREE.TextGeometry('228.300000', textOptions);
            var textMesh = new THREE.Mesh(textGeo, new THREE.MeshBasicMaterial());
            textMesh.position.set(-6, 211, 50);

            _this.data.scene.add(textMesh);
          });
          this.data.renderer = new THREE.WebGLRenderer({
            antialias: true
          });
          this.data.renderer.setPixelRatio(window.devicePixelRatio);
          this.data.renderer.setSize(window.innerWidth, window.innerHeight);
          this.data.renderer.shadowMap.enabled = true;
          this.$el.appendChild(this.data.renderer.domElement); // window.addEventListener( 'resize', this.onWindowResize, false );
        },
        "animate": function animate() {
          var _this2 = this;

          var delta = this.data.clock.getDelta();

          if (this.data.runing) {
            // 旋转模型
            if (this.data.scene.rotation.y < -Math.PI * 2) this.data.scene.rotation.y = 0; // 模式为旋转

            this.data.scene.rotation.y -= Math.PI * 0.0005;
          } // this.data.arrow_box.position.y ++


          this.data.renderer.render(this.data.scene, this.data.camera);
          setTimeout(function() {
            _this2.animate();
          }, 25);
        },
        "onWindowResize": function onWindowResize() {
          this.data.camera.aspect = window.innerWidth / window.innerHeight;
          this.data.camera.updateProjectionMatrix();
          this.data.renderer.setSize(window.innerWidth, window.innerHeight);
        },
        "created": function created() {
          if (WEBGL.isWebGLAvailable() === false) {
            document.body.appendChild(WEBGL.getWebGLErrorMessage());
          }

          console.log(this);
          this.data.clock = new THREE.Clock();
          this.init();
          this.animate();
        },
        "stop": function stop() {
          console.log('停止自动旋转!');
          this.data.runing = false;
        },
        "openWindow": function openWindow(name) {
          owo.script.home.data.scene.children[2].getObjectByName(name).rotation.x = -0.5;
        },
        "closeWindow": function closeWindow(name) {
          owo.script.home.data.scene.children[2].getObjectByName(name).rotation.x = 0;
        }
      }
    };
  </script>
  <!-- 框架script文件 -->
  <script src="./static/js/owo.main.js" type="text/javascript" charset="UTF-8"></script>
  <!-- 调试-热刷新代码 -->
  <script src="./static/js/autoReload.js" type="text/javascript" charset="UTF-8"></script>
  <!-- 调试-远程调试 -->
  <script src="./static/js/log.js" type="text/javascript" charset="UTF-8"></script>

  <script src="./static/js/three.js.js" type="text/javascript" charset="UTF-8"></script>
  <script src="./static/js/FBXLoader.js" type="text/javascript" charset="UTF-8"></script>
  <script src="./static/js/OrbitControls.js" type="text/javascript" charset="UTF-8"></script>
  <script src="./static/js/WebGL.js" type="text/javascript" charset="UTF-8"></script>
  <script src="./static/js/inflate.min.js" type="text/javascript" charset="UTF-8"></script>
  <script src="./static/js/RectAreaLightUniformsLib.js" type="text/javascript" charset="UTF-8"></script>
</body>

</html>